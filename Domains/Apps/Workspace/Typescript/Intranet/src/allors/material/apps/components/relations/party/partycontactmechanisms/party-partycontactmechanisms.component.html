<mat-card>

    <div class="row">
        <div class="col">
            <h2>
                <mat-icon>contacts</mat-icon> Contact Info
            </h2>
        </div>

        <div class="col">
            <mat-button-toggle-group [(ngModel)]="contactMechanismsCollection">
                <mat-button-toggle value="Current">Current</mat-button-toggle>
                <mat-button-toggle value="Inactive">Inactive</mat-button-toggle>
                <mat-button-toggle value="All">All</mat-button-toggle>
            </mat-button-toggle-group>
        </div>
    </div>

    <mat-card-content>

        <ul *ngIf="contactMechanisms?.length == 0">
            <li>no info to display</li>
        </ul>

        <mat-list>
            <mat-list-item *ngFor="let partyContactMechanism of this.contactMechanisms; let last=last" [attr.data-allors-id]="partyContactMechanism.id" (click)="edit.emit(partyContactMechanism)">

                <h3 mat-line> {{partyContactMechanism.ContactPurpose?.Name}}</h3>
                <h3 mat-line> {{partyContactMechanism.Contact}}</h3>
                <div mat-line *ngIf="partyContactMechanism.ContactMechanism.objectType === allors.m.EmailAddress">{{ partyContactMechanism.ContactMechanism.ElectronicAddressString}} </div>
                <div mat-line *ngIf="partyContactMechanism.ContactMechanism.objectType === allors.m.WebAddress">{{ partyContactMechanism.ContactMechanism.ElectronicAddressString}}</div>
                <div mat-line *ngIf="partyContactMechanism.ContactMechanism.objectType === allors.m.TelecommunicationsNumber">{{ partyContactMechanism.ContactMechanism.CountryCode}} {{ partyContactMechanism.ContactMechanism.AreaCode}} {{ partyContactMechanism.ContactMechanism.ContactNumber}}</div>
                <div mat-line *ngIf="partyContactMechanism.ContactMechanism.objectType === allors.m.PostalAddress">{{ partyContactMechanism.ContactMechanism.Address1}} {{ partyContactMechanism.ContactMechanism.PostalBoundary?.PostalCode}} 
                    {{partyContactMechanism.ContactMechanism.PostalBoundary?.Locality}} {{ partyContactMechanism.ContactMechanism.PostalBoundary?.Country.Name}}</div>
                <p mat-line *ngFor="let contactPurpose of partyContactMechanism.ContactPurposes">{{ contactPurpose.Name }} </p>

                <p mat-line> last modified: {{ partyContactMechanism.LastModifiedDate | date : 'shortDate' }} </p>

                <div (click)="$event.stopPropagation()">
                    <button mat-icon-button [mat-menu-trigger-for]="menuEditContact">
                        <mat-icon>more_vert</mat-icon>
                    </button>
                    <mat-menu #menuEditContact="matMenu">
                        <a (click)="edit.emit(partyContactMechanism.ContactMechanism)" mat-menu-item>Edit</a>
                        <button mat-menu-item (click)="remove.emit(partyContactMechanism)" [disabled]="!!partyContactMechanism.ThroughDate">Remove</button>
                        <button mat-menu-item (click)="activate.emit(partyContactMechanism)" [disabled]="!partyContactMechanism.ThroughDate">Activate</button>
                        <button mat-menu-item (click)="delete.emit(partyContactMechanism.ContactMechanism)" [disabled]="!partyContactMechanism.ContactMechanism.CanExecuteDelete">Delete</button>
                    </mat-menu>
                </div>

                <mat-divider *ngIf="!last" mat-inset></mat-divider>
            </mat-list-item>

        </mat-list>
    </mat-card-content>

    <mat-card-actions>

        <button mat-button [matMenuTriggerFor]="menuAddContact">Add new</button>
        <mat-menu #menuAddContact="matMenu">
            <button mat-menu-item (click)="add.emit(allors.m.WebAddress._objectType)">Web</button>
            <button mat-menu-item (click)="add.emit(allors.m.EmailAddress._objectType)">Email</button>
            <button mat-menu-item (click)="add.emit(allors.m.PostalAddress._objectType)">Postal</button>
            <button mat-menu-item (click)="add.emit(allors.m.TelecommunicationsNumber._objectType)">Telecom</button>
        </mat-menu>

    </mat-card-actions>

</mat-card>