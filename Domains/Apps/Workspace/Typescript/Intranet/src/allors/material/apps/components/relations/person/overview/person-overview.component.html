<div class="a-main">

  <div class="a-breadcrumb container-fluid mat-elevation-z4">
    <div class="row">
      <div class="col">
        <a [routerLink]="['/relations/people']">People</a> / {{person?.displayName}}
      </div>
    </div>
  </div>

  <div class="a-overview container-fluid">

    <div *ngIf="person" class="row">

      <div class="col-md-6">
        <mat-card>

          <div class="row">
            <div class="col">
              <h2>
                <mat-icon>person</mat-icon> Person
              </h2>
            </div>
          </div>

          <mat-card-content>
            <div class="container">
              <div class="row">
                <a-mat-static class="col" *ngIf="person.Salutation" [object]="person" [roleType]="m.Person.Salutation" display="Name"></a-mat-static>
                <mat-form-field class="col">
                  <input matInput type="string" [ngModel]="person.displayName" name="name" placeholder="Name" readonly>
                </mat-form-field>
              </div>

              <div class="row">
                <a-mat-static class="col" *ngIf="organisation" [object]="organisation" [roleType]="m.Organisation.Name" label="Organisation" [routerLink]="['/relations/organisation/' + organisation.id]"></a-mat-static>
                <mat-form-field class="col">
                  <input matInput type="string" [ngModel]="contactKindsText" name="contactKind" placeholder="Contact Kind" readonly />
                </mat-form-field>
              </div>

              <div class="row">
                <a-mat-static class="col" *ngIf="person.Function" [object]="person" [roleType]="m.Person.Function"></a-mat-static>
                <!--
              <a-mat-static *ngIf="person.Gender" [object]="person" [roleType]="m.Person.Gender" display="Name"></a-mat-static>
      -->
                <a-mat-static class="col" [object]="person" [roleType]="m.Person.Locale" display="Name"></a-mat-static>
              </div>

              <div class="row">
                <a-mat-static class="col" *ngIf="person.Comment " [object]="person" [roleType]="m.Person.Comment"></a-mat-static>
              </div>

              <div class="row">
                <caption class="col"> last modified: {{ person.LastModifiedDate | date}} by {{ person.LastModifiedBy?.displayName}}</caption>
              </div>
            </div>
          </mat-card-content>

          <mat-card-actions>
            <button mat-button [routerLink]="['/person/' + person.id]">Edit</button>
          </mat-card-actions>
        </mat-card>
      </div>

      <div class="col-md-6">
        <party-communicationevents [communicationEvents]='communicationEvents' (add)="navigation.add($event, person)" (delete)="deleteCommunication($event)"></party-communicationevents>
      </div>

      <div class="col-md-6">
        <party-partycontactmechanisms [currentContactMechanisms]='currentContactMechanisms' [inactiveContactMechanisms]='inactiveContactMechanisms' [allContactMechanisms]='allContactMechanisms' (add)="navigation.add($event, person)" (edit)="navigation.edit($event, person)" (remove)="removeContactMechanism($event)" (delete)="deleteCommunication($event)" (activate)="activateContactMechanism($event)"></party-partycontactmechanisms>
      </div>

      <div class="col-md-6">
        <mat-card>

          <div class="row">
            <div class="col">
              <h2>
                <mat-icon>work</mat-icon> Work Efforts
              </h2>
            </div>
          </div>

          <mat-card-content>

            <ul *ngIf="workEffortAssignments?.length == 0">
              <li>no work efforts to display</li>
            </ul>

            <mat-list>
              <mat-list-item *ngFor="let workEffortAssignment of this.workEffortAssignments; let last=last" [attr.data-allors-id]="workEffortAssignment.id">
                <div mat-line [routerLink]="['/worktask/' + workEffortAssignment.Assignment.id ]">
                  {{ workEffortAssignment.Assignment.Name }}, {{ workEffortAssignment.Assignment.WorkEffortState.Name }}
                </div>

                <p mat-line>{{ workEffortAssignment.Assignment.Description }} </p>
                <p *ngIf="workEffortAssignment.Assignment.Priority" mat-line>Priority {{ workEffortAssignment.Assignment.Priority.Name }} </p>

                <span>
                  <div> Sched. Start: {{ workEffortAssignment.Assignment.ScheduledStart | date}} </div>
                  <div> Sched. Compl.: {{ workEffortAssignment.Assignment.ScheduledCompletion | date }} </div>
                  <div> Act. Start: {{ workEffortAssignment.Assignment.ActualStart | date}} </div>
                  <div> Act. Compl.: {{ workEffortAssignment.Assignment.ActualCompletion | date }} </div>
                </span>

                <div>
                  <button mat-icon-button [mat-menu-trigger-for]="menuEditWork">
                    <mat-icon>more_vert</mat-icon>
                  </button>
                  <mat-menu #menuEditWork="matMenu">
                    <a [routerLink]="['/worktask/' + workEffortAssignment.Assignment.id]" mat-menu-item>Edit</a>
                    <button mat-menu-item (click)="delete(workEffortAssignment.Assignment)" [disabled]="!workEffortAssignment.Assignment.CanExecuteDelete">Delete</button>
                  </mat-menu>
                </div>

                <mat-divider *ngIf="!last" mat-inset></mat-divider>

              </mat-list-item>
            </mat-list>
          </mat-card-content>

          <mat-card-actions>
            <button mat-button [routerLink]="['/worktask']">Add new</button>
          </mat-card-actions>
        </mat-card>
      </div>
    </div>
  </div>
</div>